import{i as W,B as Q,S as f,E as B,y as X,C as b,q as I,I as k,l as Z,p as ee}from"./vendor.e711fc39.js";const ne=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}};ne();const te={apiKey:"AIzaSyB7Jkv647eebeqifG6mAHv40fUyfdDRB8k",authDomain:"fireship-demos-ce28a.firebaseapp.com",databaseURL:"https://fireship-demos-ce28a-default-rtdb.firebaseio.com",projectId:"fireship-demos-ce28a",storageBucket:"fireship-demos-ce28a.appspot.com",messagingSenderId:"710932691797",appId:"1:710932691797:web:5838b9fd459ba264af4ddc",measurementId:"G-FNWH5RC87G"};W(te);const ae={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},s=new RTCPeerConnection(ae);let v=null,E=null;const q=document.getElementById("webcamButton"),g=document.getElementById("webcamVideo"),x=document.getElementById("callButton"),R=document.getElementById("callInput"),D=document.getElementById("answerButton"),L=document.getElementById("remoteVideo"),oe=document.getElementById("hangupButton"),ce=document.getElementById("testButton"),A=document.getElementById("callMessage");Nexus.colors.accent="#2596be";Nexus.colors.fill="#333";var ie=new Nexus.Toggle("#muteMo",{state:!0});ie.on("change",function(o){document.getElementById("muteMonitor").click()});var se=new Nexus.Toggle("#muteMy");se.on("change",function(o){document.getElementById("muteMe").click()});var le=new Nexus.Select("audioSourceSelect",{size:[200,20],options:["Default - MacBook Pro Microphone","iPhone"]});le.colorize("fill","#eee");var re=new Nexus.Select("audioOutputSelect",{size:[200,20],options:["Defalut - MacBook Pro Speakers (Built-in)"]});re.colorize("fill","#eee");var P=new Nexus.TextButton("#startDevices",{size:[150,50],state:!1,text:"Init",alternateText:"Activated"});P.colorize("fill","#eee");P.on("change",function(o){q.click()});var de=new Nexus.Dial("#comp_threshold",{size:[50,50],interaction:"radial",mode:"relative",min:-100,max:0,step:1,value:-24}),G=new Nexus.Dial("#comp_knee",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:40,step:1,value:30}),V=new Nexus.Dial("#comp_ratio",{size:[50,50],interaction:"radial",mode:"relative",min:1,max:20,step:1,value:12});new Nexus.Dial("#comp_reduction",{size:[50,50],interaction:"radial",mode:"relative",min:-20,max:0,step:1,value:0});var F=new Nexus.Dial("#comp_attack",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:1,step:.01,value:.003}),z=new Nexus.Dial("#comp_release",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:1,step:.05,value:.25}),j=new Nexus.Toggle("#comp_bypass");new Nexus.Dial("#reverb",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:1,value:10});new Nexus.Toggle("#rev_bypass");var J=new Nexus.Toggle("#eq_bypass"),C=new Nexus.Select("eq_type",{size:[200,20],options:["lowshelf","highshelf"]}),S=new Nexus.Slider("eq_freq",{size:[120,20],mode:"relative",min:20,max:2e4,step:100,value:1e3}),T=new Nexus.Dial("#eq1",{size:[50,50],interaction:"radial",mode:"relative",min:-20,max:40,step:0,value:10});new Nexus.Dial("#eq2",{size:[50,50],interaction:"radial",mode:"relative",min:-20,max:40,step:0,value:10});new Nexus.Dial("#eq3",{size:[50,50],interaction:"radial",mode:"relative",min:-20,max:40,step:0,value:10});var U=new Nexus.Toggle("#gain_bypass"),h=new Nexus.Dial("#gain",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:1,value:2}),H=new Nexus.Toggle("#pan_bypass"),N=new Nexus.Dial("#pan",{size:[50,50],interaction:"radial",mode:"relative",min:-1,max:1,step:.1,value:0});const ue=document.getElementById("remoteVideo"),w=document.getElementById("audioSource"),y=document.getElementById("audioOutput"),_=[w,y];function me(o){const c=_.map(n=>n.value);_.forEach(n=>{for(;n.firstChild;)n.removeChild(n.firstChild)});for(let n=0;n!==o.length;++n){const a=o[n],e=document.createElement("option");e.value=a.deviceId,a.kind==="audioinput"?(e.text=a.label||`microphone ${w.length+1}`,w.appendChild(e)):a.kind==="audiooutput"&&(e.text=a.label||`speaker ${y.length+1}`,y.appendChild(e))}_.forEach((n,a)=>{Array.prototype.slice.call(n.childNodes).some(e=>e.value===c[a])&&(n.value=c[a])})}navigator.mediaDevices.enumerateDevices().then(me).catch(console.log("media query success"));function pe(){const o=y.value;ue.setSinkId(o).then(console.log("success"))}function K(){return{audio:{deviceId:w.value,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,sampleRate:48e3,sampleSize:16,volume:1},video:!1}}var Y=K();w.addEventListener("change",function(){Y=K()});y.onchange=pe;q.onclick=async()=>{v=await navigator.mediaDevices.getUserMedia(Y),E=new MediaStream,v.getTracks().forEach(o=>{s.addTrack(o,v)}),s.ontrack=o=>{console.log("case2"),o.streams[0].getTracks().forEach(c=>{console.log(c),E.addTrack(c)})},L.srcObject=E,g.play(),L.play(),x.disabled=!1,D.disabled=!1,q.disabled=!0};const M=document.getElementById("muteMonitor");M.checked==!0?g.muted=!0:g.muted=!1;M.addEventListener("change",function(){M.checked==!0?(g.muted=!0,console.log("monitor muted")):(g.muted=!1,console.log("monitor unmuted"))});const O=document.getElementById("muteMe");O.checked=!1;O.addEventListener("change",function(){O.checked==!0?(v.getTracks()[0].enabled=!1,console.log("muted me")):(v.getTracks()[0].enabled=!0,console.log("unmuted me"))});const u=Q();x.onclick=async()=>{let o=document.createTextNode("You created a call.");A.appendChild(o),x.disabled=!0,D.disabled=!0;const c=f(u,"calls1"),n=await B(c,{});R.value=n.id;const a=f(u,"calls1",n.id,"offerCandidates"),e=f(u,"calls1",n.id,"answerCandidates");s.onicecandidate=m=>{m.candidate&&B(a,m.candidate.toJSON())};const t=await s.createOffer();t.sdp=t.sdp.replace("useinbandfec=1","useinbandfec=1; stereo=1; maxaveragebitrate=510000"),await s.setLocalDescription(t),console.log("offerdescription from pa",t);const r={sdp:t.sdp,type:t.type};await X(b(u,"calls1",n.id),{offer:r}),console.log("offer from pa",r);const d=I(b(u,"calls1",n.id));k(d,m=>{const l=m.data();if(!s.currentRemoteDescription&&(l==null?void 0:l.answer)){const p=new RTCSessionDescription(l.answer);s.setRemoteDescription(p),console.log("answerdescription from pa",p)}});const i=I(e);k(i,m=>{m.docChanges().forEach(l=>{if(l.type==="added"){const p=new RTCIceCandidate(l.doc.data());s.addIceCandidate(p),console.log("candidate from pa",p)}})}),oe.disabled=!1};D.onclick=async()=>{let o=document.createTextNode("You answered a call!");A.appendChild(o),x.disabled=!0,D.disabled=!0;const c=R.value,n=f(u,"calls1"),a=f(u,"calls1",c,"answerCandidates"),e=f(u,"calls1",c,"offerCandidates");s.onicecandidate=l=>{l.candidate&&B(a,l.candidate.toJSON())};const t=(await Z(b(n,c))).data();console.log(t);const r=t.offer;await s.setRemoteDescription(new RTCSessionDescription(r));const d=await s.createAnswer();d.sdp=d.sdp.replace("useinbandfec=1","useinbandfec=1; stereo=1; maxaveragebitrate=510000"),await s.setLocalDescription(d),console.log("answerDescription from pb",d);const i={type:d.type,sdp:d.sdp};await ee(b(u,"calls1",c),{answer:i}),console.log("answer from pb",i);const m=I(e);k(m,l=>{l.docChanges().forEach(p=>{if(p.type==="added"){let $=p.doc.data();s.addIceCandidate(new RTCIceCandidate($))}})})};ce.onclick=async()=>{console.log("button has been pushed");var o=new AudioContext,c=o.createMediaStreamSource(v),n=o.createBiquadFilter();n.type=C.value,n.frequency.value=S.value,n.gain.value=h.value;var a=o.createStereoPanner();a.pan.value=N.value;var e=o.createGain();e.gain.value=h.value;var t=o.createDynamicsCompressor();t.release.value=z.value,c.connect(t),t.connect(n),n.connect(e),e.connect(a),a.connect(o.destination),de.on("change",function(i){t.release.value=z.value,console.log(z)}),F.on("change",function(i){t.attack.value=F.value}),G.on("change",function(i){t.knee.value=G.value}),V.on("change",function(i){t.ratio.value=V.value}),C.on("change",function(i){n.type=C.value,console.log(C.value)}),S.on("change",function(i){n.frequency.value=S.value,console.log(S)}),T.on("change",function(i){n.gain.value=T.value,console.log(T.value)}),N.on("change",function(i){a.pan.value=N.value,console.log(N.value)}),h.on("change",function(i){e.gain.value=h.value,console.log(h.value)}),j.on("change",function(i){j.state==!0?(t.disconnect(),c.connect(n),n.connect(e),e.connect(a),a.connect(o.destination)):(c.connect(t),t.connect(n),n.connect(e),e.connect(a),a.connect(o.destination))}),J.on("change",function(i){J.state==!0?(n.disconnect(),c.connect(t),t.connect(e),e.connect(a),a.connect(o.destination)):(c.connect(t),t.connect(n),n.connect(e),e.connect(a),a.connect(o.destination))}),U.on("change",function(i){U.state==!0?(e.disconnect(),c.connect(t),t.connect(n),n.connect(a),a.connect(o.destination)):(c.connect(t),t.connect(n),n.connect(e),e.connect(a),a.connect(o.destination))}),H.on("change",function(i){H.state==!0?(a.disconnect(),c.connect(t),t.connect(n),n.connect(e),e.connect(o.destination)):(c.connect(t),t.connect(n),n.connect(e),e.connect(a),a.connect(o.destination))});var r=new Nexus.Oscilloscope("#oScope");r.connect(c);var d=new Nexus.Spectrogram("#spec");d.connect(c)};
