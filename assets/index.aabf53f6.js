import{i as F,B as G,S as p,E as C,y as j,C as y,q as B,I,l as J,p as U}from"./vendor.e711fc39.js";const H=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}};H();const K={apiKey:"AIzaSyB7Jkv647eebeqifG6mAHv40fUyfdDRB8k",authDomain:"fireship-demos-ce28a.firebaseapp.com",databaseURL:"https://fireship-demos-ce28a-default-rtdb.firebaseio.com",projectId:"fireship-demos-ce28a",storageBucket:"fireship-demos-ce28a.appspot.com",messagingSenderId:"710932691797",appId:"1:710932691797:web:5838b9fd459ba264af4ddc",measurementId:"G-FNWH5RC87G"};F(K);const Y={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},s=new RTCPeerConnection(Y);let f=null,D=null;const x=document.getElementById("webcamButton"),g=document.getElementById("webcamVideo"),b=document.getElementById("callButton"),q=document.getElementById("callInput"),S=document.getElementById("answerButton"),z=document.getElementById("remoteVideo"),$=document.getElementById("hangupButton"),W=document.getElementById("testButton"),O=document.getElementById("callMessage");Nexus.colors.accent="#2596be";Nexus.colors.fill="#333";var R=new Nexus.Toggle("#muteMo");R.on("change",function(a){document.getElementById("muteMonitor").click()});new Nexus.Toggle("#muteMy");R.on("change",function(a){document.getElementById("muteMe").click()});var Q=new Nexus.Select("audioSourceSelect",{size:[200,20],options:["Default - MacBook Pro Microphone","iPhone"]});Q.colorize("fill","#eee");var X=new Nexus.Select("audioOutputSelect",{size:[200,20],options:["Defalut - MacBook Pro Speakers (Built-in)"]});X.colorize("fill","#eee");var L=new Nexus.TextButton("#startDevices",{size:[150,50],state:!1,text:"Init",alternateText:"Activated"});L.colorize("fill","#eee");L.on("change",function(a){x.click()});new Nexus.Envelope("#compressor");new Nexus.Dial("#reverb",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:0,value:10});new Nexus.Dial("#eq1",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:0,value:10});new Nexus.Dial("#eq2",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:0,value:10});new Nexus.Dial("#eq3",{size:[50,50],interaction:"radial",mode:"relative",min:0,max:20,step:0,value:10});var E=new Nexus.Dial("#gain",{size:[50,50],interaction:"radial",mode:"relative",min:-20,max:40,step:0,value:0}),k=new Nexus.Dial("#pan",{size:[50,50],interaction:"radial",mode:"relative",min:-1,max:1,step:.1,value:0});const Z=document.getElementById("remoteVideo"),v=document.getElementById("audioSource"),h=document.getElementById("audioOutput"),N=[v,h];function _(a){const n=N.map(t=>t.value);N.forEach(t=>{for(;t.firstChild;)t.removeChild(t.firstChild)});for(let t=0;t!==a.length;++t){const c=a[t],e=document.createElement("option");e.value=c.deviceId,c.kind==="audioinput"?(e.text=c.label||`microphone ${v.length+1}`,v.appendChild(e)):c.kind==="audiooutput"&&(e.text=c.label||`speaker ${h.length+1}`,h.appendChild(e))}N.forEach((t,c)=>{Array.prototype.slice.call(t.childNodes).some(e=>e.value===n[c])&&(t.value=n[c])})}navigator.mediaDevices.enumerateDevices().then(_).catch(console.log("media query success"));function ee(){const a=h.value;Z.setSinkId(a).then(console.log("success"))}function A(){return{audio:{deviceId:v.value,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,latency:0,sampleRate:48e3,sampleSize:16,volume:1},video:!1}}var P=A();v.addEventListener("change",function(){P=A()});h.onchange=ee;x.onclick=async()=>{f=await navigator.mediaDevices.getUserMedia(P),D=new MediaStream,f.getTracks().forEach(a=>{s.addTrack(a,f)}),s.ontrack=a=>{console.log("case2"),a.streams[0].getTracks().forEach(n=>{console.log(n),D.addTrack(n)})},z.srcObject=D,g.play(),z.play(),b.disabled=!1,S.disabled=!1,x.disabled=!0};const M=document.getElementById("muteMonitor");M.checked==!0?g.muted=!0:g.muted=!1;M.addEventListener("change",function(){M.checked==!0?(g.muted=!0,console.log("monitor muted")):(g.muted=!1,console.log("monitor unmuted"))});const T=document.getElementById("muteMe");T.checked=!1;T.addEventListener("change",function(){T.checked==!0?(f.getTracks()[0].enabled=!1,console.log("muted me")):(f.getTracks()[0].enabled=!0,console.log("unmuted me"))});const d=G();b.onclick=async()=>{let a=document.createTextNode("You created a call.");O.appendChild(a),b.disabled=!0,S.disabled=!0;const n=p(d,"calls1"),t=await C(n,{});q.value=t.id;const c=p(d,"calls1",t.id,"offerCandidates"),e=p(d,"calls1",t.id,"answerCandidates");s.onicecandidate=u=>{u.candidate&&C(c,u.candidate.toJSON())};const o=await s.createOffer();o.sdp=o.sdp.replace("useinbandfec=1","useinbandfec=1; stereo=1; maxaveragebitrate=510000"),await s.setLocalDescription(o),console.log("offerdescription from pa",o);const l={sdp:o.sdp,type:o.type};await j(y(d,"calls1",t.id),{offer:l}),console.log("offer from pa",l);const r=B(y(d,"calls1",t.id));I(r,u=>{const i=u.data();if(!s.currentRemoteDescription&&(i==null?void 0:i.answer)){const m=new RTCSessionDescription(i.answer);s.setRemoteDescription(m),console.log("answerdescription from pa",m)}});const w=B(e);I(w,u=>{u.docChanges().forEach(i=>{if(i.type==="added"){const m=new RTCIceCandidate(i.doc.data());s.addIceCandidate(m),console.log("candidate from pa",m)}})}),$.disabled=!1};S.onclick=async()=>{let a=document.createTextNode("You answered a call!");O.appendChild(a),b.disabled=!0,S.disabled=!0;const n=q.value,t=p(d,"calls1"),c=p(d,"calls1",n,"answerCandidates"),e=p(d,"calls1",n,"offerCandidates");s.onicecandidate=i=>{i.candidate&&C(c,i.candidate.toJSON())};const o=(await J(y(t,n))).data();console.log(o);const l=o.offer;await s.setRemoteDescription(new RTCSessionDescription(l));const r=await s.createAnswer();r.sdp=r.sdp.replace("useinbandfec=1","useinbandfec=1; stereo=1; maxaveragebitrate=510000"),await s.setLocalDescription(r),console.log("answerDescription from pb",r);const w={type:r.type,sdp:r.sdp};await U(y(d,"calls1",n),{answer:w}),console.log("answer from pb",w);const u=B(e);I(u,i=>{i.docChanges().forEach(m=>{if(m.type==="added"){let V=m.doc.data();s.addIceCandidate(new RTCIceCandidate(V))}})})};W.onclick=async()=>{console.log("button has been pushed");var a=document.querySelector("#gain"),n=document.querySelector("#pan"),t=new AudioContext,c=t.createMediaStreamSource(f),e=t.createBiquadFilter();e.type="lowshelf",e.frequency.value=1e3,e.gain.value=E.value;var o=t.createStereoPanner();o.pan.value=k.value,c.connect(e),e.connect(o),o.connect(t.destination),n.onclick=function(){o.pan.value=k.value,console.log(k.value)},a.onclick=function(){e.gain.value=E.value,console.log(E.value)};var l=new Nexus.Oscilloscope("#oScope");l.connect(c);var r=new Nexus.Spectrogram("#spec");r.connect(c)};
